<!DOCTYPE html>
<!-- build: fde3e7c 2026-02-14T06:50:51Z -->
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Grace AI Concierge | Command Center</title>
  <meta name="description" content="AI-powered voice-native hotel concierge system">
  <link rel="icon" href="https://z-cdn.chatglm.cn/z-ai/static/logo.svg">

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            slate: { 950: '#020617', 900: '#0f172a', 800: '#1e293b' },
            purple: { 400: '#c084fc', 500: '#a855f7', 600: '#9333ea' },
            cyan: { 400: '#22d3ee', 500: '#06b6d4' },
            pink: { 400: '#f472b6', 500: '#ec4899' }
          }
        }
      }
    }
  </script>

  <style>
    :root {
      --panel-bg: rgba(8, 12, 20, 0.78);
      --panel-border: rgba(34, 211, 238, 0.18);
      --panel-glow: rgba(34, 211, 238, 0.2);
    }

    .scanlines {
      position: fixed;
      inset: 0;
      pointer-events: none;
      background: linear-gradient(to bottom, rgba(255, 255, 255, 0.04) 1px, transparent 1px);
      background-size: 100% 4px;
      mix-blend-mode: soft-light;
      opacity: 0.35;
      z-index: 1;
    }

    .grid-overlay {
      position: fixed;
      inset: 0;
      pointer-events: none;
      background-image: linear-gradient(rgba(148, 163, 184, 0.08) 1px, transparent 1px),
        linear-gradient(90deg, rgba(148, 163, 184, 0.08) 1px, transparent 1px);
      background-size: 60px 60px;
      opacity: 0.25;
      z-index: 1;
    }

    .glass-panel {
      background: var(--panel-bg);
      border: 1px solid var(--panel-border);
      backdrop-filter: blur(16px);
      box-shadow: 0 0 24px rgba(30, 64, 175, 0.2), 0 20px 60px rgba(15, 23, 42, 0.55);
    }

    .glow-hover:hover {
      box-shadow: 0 0 30px var(--panel-glow);
      transform: translateY(-2px);
    }

    .status-dot {
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%,
      100% {
        opacity: 1;
      }
      50% {
        opacity: 0.55;
      }
    }

    .truncate-lines {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .modal-enter {
      animation: modalIn 0.2s ease-out;
    }

    @keyframes modalIn {
      from {
        opacity: 0;
        transform: translateY(20px) scale(0.98);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: #0f172a;
    }

    ::-webkit-scrollbar-thumb {
      background: #4c1d95;
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #6d28d9;
    }
  </style>
</head>

<body class="bg-gradient-to-br from-slate-950 via-purple-950/20 to-slate-950 min-h-screen text-white overflow-x-hidden">
  <div class="grid-overlay"></div>
  <div class="scanlines"></div>

  <div class="fixed top-1/4 left-1/4 w-96 h-96 bg-purple-600/10 rounded-full blur-3xl animate-pulse pointer-events-none"></div>
  <div class="fixed bottom-1/4 right-1/4 w-96 h-96 bg-cyan-600/10 rounded-full blur-3xl animate-pulse pointer-events-none delay-1000"></div>

  <header class="sticky top-0 z-40 border-b border-purple-500/20 backdrop-blur-xl bg-slate-950/80">
    <div class="container mx-auto px-4 py-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-4">
          <div class="relative">
            <i class="fas fa-robot text-purple-400 text-2xl"></i>
            <span class="absolute -top-1 -right-1 h-3 w-3 bg-green-500 rounded-full status-dot"></span>
          </div>
          <div>
            <h1 class="text-2xl font-bold bg-gradient-to-r from-purple-400 via-cyan-400 to-purple-400 bg-clip-text text-transparent">
              GRACE AI
            </h1>
            <p class="text-xs text-slate-400 font-mono tracking-widest">CONCIERGE COMMAND CENTER</p>
          </div>
        </div>
        <div class="flex items-center gap-6">
          <div class="text-right hidden md:block">
            <p class="text-xs text-purple-400 font-mono">SYSTEM TIME</p>
            <p class="text-sm font-mono text-cyan-400" id="system-time">--:--:--</p>
          </div>
          <div class="flex items-center gap-2 text-xs text-green-400 font-mono border border-green-500/30 px-3 py-1 rounded-full bg-green-500/10">
            <div class="w-2 h-2 bg-green-500 rounded-full status-dot"></div>
            OPERATIONAL
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 py-8 relative z-10">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
      <div class="glass-panel rounded-2xl p-6 glow-hover transition-all">
        <div class="flex justify-between items-start mb-4">
          <h2 class="text-sm text-purple-400 font-mono uppercase">Total Tickets</h2>
          <i class="fas fa-database text-cyan-400 text-xl"></i>
        </div>
        <div class="text-4xl font-bold text-white" id="stat-total">0</div>
        <p class="text-xs text-slate-500 mt-2 font-mono">LIFETIME LOGS</p>
      </div>

      <div class="glass-panel rounded-2xl p-6 glow-hover transition-all">
        <div class="flex justify-between items-start mb-4">
          <h2 class="text-sm text-green-400 font-mono uppercase">Open Tickets</h2>
          <i class="fas fa-signal text-green-400 text-xl"></i>
        </div>
        <div class="text-4xl font-bold text-white" id="stat-open">0</div>
        <p class="text-xs text-slate-500 mt-2 font-mono">ACTIVE REQUESTS</p>
      </div>

      <div class="glass-panel rounded-2xl p-6 glow-hover transition-all">
        <div class="flex justify-between items-start mb-4">
          <h2 class="text-sm text-cyan-400 font-mono uppercase">Sentiment</h2>
          <i class="fas fa-brain text-purple-400 text-xl"></i>
        </div>
        <div class="text-4xl font-bold text-white" id="stat-sentiment">98%</div>
        <p class="text-xs text-slate-500 mt-2 font-mono">AI CONFIDENCE</p>
      </div>
    </div>

    <div class="glass-panel rounded-2xl p-6">
      <div class="flex flex-wrap items-center justify-between gap-4 mb-6">
        <h2 class="text-xl font-bold flex items-center gap-3">
          <i class="fas fa-list text-purple-400"></i>
          <span class="bg-gradient-to-r from-purple-400 to-cyan-400 bg-clip-text text-transparent">Live Tickets</span>
        </h2>
        <button id="create-test-ticket"
          class="text-xs bg-slate-800 hover:bg-slate-700 text-emerald-300 border border-emerald-500/30 px-4 py-2 rounded-lg transition-all flex items-center gap-2">
          <i class="fas fa-plus"></i> Test Ticket
        </button>
      </div>

      <div id="error-banner"
        class="hidden mb-4 rounded-xl border border-red-500/40 bg-red-950/30 px-4 py-3 text-xs text-red-200 font-mono">
        <span class="text-red-300 font-semibold">SYSTEM ALERT:</span>
        <span id="error-message">Unable to load data.</span>
      </div>

      <div class="grid grid-cols-1 xl:grid-cols-12 gap-4 mb-6">
        <div class="xl:col-span-6">
          <label class="flex items-center gap-2 text-xs text-slate-300 font-mono">
            <i class="fas fa-search text-cyan-400"></i>
            <input id="search-input" type="text" placeholder="Search guest, room, issue..."
              class="w-full bg-slate-900/60 border border-cyan-500/20 rounded-md px-3 py-2 text-xs text-slate-200 focus:outline-none focus:border-cyan-400/80" />
          </label>
        </div>
        <div class="xl:col-span-3">
          <select id="filter-status"
            class="w-full bg-slate-900/60 border border-purple-500/20 rounded-md px-3 py-2 text-xs text-purple-200 focus:outline-none focus:border-purple-400/80">
            <option value="all">All Status</option>
            <option value="OPEN">Open</option>
            <option value="RESOLVED">Resolved</option>
            <option value="CLOSED">Closed</option>
          </select>
        </div>
        <div class="xl:col-span-3">
          <button id="sort-created"
            class="w-full bg-slate-900/60 border border-cyan-500/30 rounded-md px-3 py-2 text-xs text-cyan-200 hover:bg-cyan-500/10 transition-all">
            Sort: Newest
          </button>
        </div>
      </div>

      <div id="loading-state" class="flex flex-col items-center justify-center h-64 text-slate-400">
        <div class="w-12 h-12 border-4 border-cyan-500/30 border-t-cyan-400 rounded-full animate-spin mb-4"></div>
        <p class="font-mono text-sm">SYNCING CONCIERGE GRID...</p>
      </div>

      <div id="empty-state" class="hidden flex flex-col items-center justify-center h-64 text-slate-500">
        <i class="fas fa-inbox text-4xl mb-4 opacity-50"></i>
        <p>No active requests found.</p>
        <p class="text-sm opacity-70 mt-1">Awaiting new signals...</p>
      </div>

      <div id="tickets-grid" class="hidden grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4"></div>
    </div>
  </main>

  <div id="ticket-modal" class="fixed inset-0 z-[100] hidden items-center justify-center">
    <div id="modal-overlay" class="absolute inset-0 bg-slate-950/80 backdrop-blur-sm"></div>
    <div class="relative w-[95%] max-w-3xl max-h-[90vh] overflow-hidden rounded-2xl border border-cyan-500/30 bg-slate-950/90 shadow-2xl shadow-cyan-500/20 modal-enter">
      <div class="flex items-center justify-between border-b border-cyan-500/20 px-6 py-4">
        <div>
          <p class="text-xs text-cyan-300 font-mono">INCIDENT REPORT</p>
          <h3 class="text-lg font-semibold text-white" id="modal-title">Ticket</h3>
          <p class="text-xs text-slate-400 font-mono" id="modal-created">—</p>
        </div>
        <button id="modal-close"
          class="text-xs uppercase tracking-widest text-cyan-300 border border-cyan-500/30 px-3 py-2 rounded-md hover:bg-cyan-500/10">
          Close
        </button>
      </div>
      <div class="px-6 py-4 space-y-4 overflow-y-auto max-h-[70vh]">
        <div class="flex flex-wrap items-center gap-3 text-xs font-mono">
          <span id="modal-id" class="px-2 py-1 rounded bg-slate-900/60 border border-cyan-500/20">ID: —</span>
          <span id="modal-status" class="px-2 py-1 rounded bg-slate-900/60 border border-purple-500/30">Status: —</span>
          <span id="modal-sentiment" class="px-2 py-1 rounded bg-slate-900/60 border border-pink-500/30">Sentiment: —</span>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm">
          <div class="p-3 rounded-lg bg-slate-900/60 border border-cyan-500/10">
            <p class="text-xs text-cyan-300 font-mono">Guest</p>
            <p id="modal-guest" class="text-white font-semibold">—</p>
          </div>
          <div class="p-3 rounded-lg bg-slate-900/60 border border-cyan-500/10">
            <p class="text-xs text-cyan-300 font-mono">Room</p>
            <p id="modal-room" class="text-white font-semibold">—</p>
          </div>
          <div class="p-3 rounded-lg bg-slate-900/60 border border-cyan-500/10">
            <p class="text-xs text-cyan-300 font-mono">Status</p>
            <p id="modal-status-text" class="text-white font-semibold">—</p>
          </div>
          <div class="p-3 rounded-lg bg-slate-900/60 border border-cyan-500/10">
            <p class="text-xs text-cyan-300 font-mono">Sentiment</p>
            <p id="modal-sentiment-text" class="text-white font-semibold">—</p>
          </div>
        </div>

        <div class="p-4 rounded-lg bg-slate-900/60 border border-purple-500/20">
          <p class="text-xs text-purple-300 font-mono">Issue</p>
          <p id="modal-issue" class="text-slate-200 mt-2 leading-relaxed">—</p>
        </div>

        <div class="p-4 rounded-lg bg-slate-900/60 border border-cyan-500/20">
          <div class="flex items-center justify-between">
            <p class="text-xs text-cyan-300 font-mono">Raw JSON</p>
            <button id="modal-copy-json"
              class="text-xs text-cyan-200 border border-cyan-500/30 px-2 py-1 rounded-md hover:bg-cyan-500/10 transition-all">
              Copy JSON
            </button>
          </div>
          <div class="mt-2 max-h-[220px] overflow-auto rounded-md bg-slate-950/70 border border-slate-700 p-3 text-xs text-slate-200">
            <pre id="modal-raw" class="whitespace-pre-wrap break-words">—</pre>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer class="border-t border-purple-500/10 bg-slate-950/80 mt-10 py-6">
    <div class="container mx-auto px-4 text-center space-y-1">
      <p class="text-xs text-slate-600 font-mono">GRACE AI SYSTEM // POWERED BY RAILWAY & GEMINI</p>
      <p class="text-xs text-cyan-300 font-mono" id="build-marker">build: unknown</p>
      <p class="text-xs text-purple-300 font-mono" id="deploy-marker">__DEPLOY_MARKER__</p>
    </div>
  </footer>

  <script>
    const API_BASE_URL = window.location.origin;

    const statTotalEl = document.getElementById('stat-total');
    const statOpenEl = document.getElementById('stat-open');
    const statSentimentEl = document.getElementById('stat-sentiment');
    const loadingStateEl = document.getElementById('loading-state');
    const emptyStateEl = document.getElementById('empty-state');
    const ticketsGridEl = document.getElementById('tickets-grid');
    const testBtn = document.getElementById('create-test-ticket');
    const errorBannerEl = document.getElementById('error-banner');
    const errorMessageEl = document.getElementById('error-message');
    const searchInputEl = document.getElementById('search-input');
    const filterStatusEl = document.getElementById('filter-status');
    const sortCreatedBtn = document.getElementById('sort-created');
    const modalEl = document.getElementById('ticket-modal');
    const modalOverlayEl = document.getElementById('modal-overlay');
    const modalCloseEl = document.getElementById('modal-close');
    const modalTitleEl = document.getElementById('modal-title');
    const modalCreatedEl = document.getElementById('modal-created');
    const modalIdEl = document.getElementById('modal-id');
    const modalStatusBadgeEl = document.getElementById('modal-status');
    const modalSentimentBadgeEl = document.getElementById('modal-sentiment');
    const modalGuestEl = document.getElementById('modal-guest');
    const modalRoomEl = document.getElementById('modal-room');
    const modalStatusTextEl = document.getElementById('modal-status-text');
    const modalSentimentTextEl = document.getElementById('modal-sentiment-text');
    const modalIssueEl = document.getElementById('modal-issue');
    const modalRawEl = document.getElementById('modal-raw');
    const modalCopyJsonBtn = document.getElementById('modal-copy-json');
    const buildMarkerEl = document.getElementById('build-marker');

    const state = {
      tickets: [],
      filtered: [],
      loading: true,
      error: null,
      sortDir: 'desc',
      filters: {
        search: '',
        status: 'all'
      }
    };

    function formatLocalDateTime(isoString) {
      if (!isoString) {
        return { display: '—', utc: 'unknown' };
      }
      const date = new Date(isoString);
      if (Number.isNaN(date.getTime())) {
        return { display: '—', utc: 'invalid' };
      }
      const pad = (value) => value.toString().padStart(2, '0');
      const display = `${date.getFullYear()}-${pad(date.getMonth() + 1)}-${pad(date.getDate())} ${pad(date.getHours())}:${pad(date.getMinutes())}`;
      const utc = `${date.getUTCFullYear()}-${pad(date.getUTCMonth() + 1)}-${pad(date.getUTCDate())} ${pad(date.getUTCHours())}:${pad(date.getUTCMinutes())} UTC`;
      return { display, utc };
    }

    function applyFilters() {
      const search = state.filters.search.toLowerCase();
      const status = state.filters.status;

      let filtered = state.tickets.filter(t => {
        const haystack = [t.guest_name, t.room_number, t.issue].join(' ').toLowerCase();
        if (search && !haystack.includes(search)) return false;
        if (status !== 'all' && t.status !== status) return false;
        return true;
      });

      filtered.sort((a, b) => {
        const aTime = new Date(a.created_at || 0).getTime();
        const bTime = new Date(b.created_at || 0).getTime();
        return state.sortDir === 'asc' ? aTime - bTime : bTime - aTime;
      });

      state.filtered = filtered;
    }

    function renderError() {
      if (errorBannerEl) {
        if (state.error) {
          errorBannerEl.classList.remove('hidden');
          if (errorMessageEl) errorMessageEl.textContent = state.error;
        } else {
          errorBannerEl.classList.add('hidden');
        }
      }
    }

    function renderTickets() {
      loadingStateEl.classList.add('hidden');
      renderError();

      if (!state.filtered.length) {
        emptyStateEl.classList.remove('hidden');
        ticketsGridEl.classList.add('hidden');
        ticketsGridEl.innerHTML = '';
        return;
      }

      emptyStateEl.classList.add('hidden');
      ticketsGridEl.classList.remove('hidden');
      ticketsGridEl.innerHTML = '';

      state.filtered.forEach(ticket => {
        const { display, utc } = formatLocalDateTime(ticket.created_at);
        const statusClass = ticket.status === 'OPEN'
          ? 'bg-red-500/20 text-red-300 border-red-500/40'
          : 'bg-emerald-500/20 text-emerald-300 border-emerald-500/40';
        const sentiment = ticket.sentiment || 'Neutral';
        const sentimentClass = sentiment.toLowerCase().includes('negative')
          ? 'bg-pink-500/20 text-pink-300 border-pink-500/40'
          : sentiment.toLowerCase().includes('positive')
            ? 'bg-emerald-500/20 text-emerald-300 border-emerald-500/40'
            : 'bg-cyan-500/20 text-cyan-200 border-cyan-500/40';

        const card = document.createElement('div');
        card.className = 'glass-panel rounded-2xl p-4 glow-hover transition-all cursor-pointer';
        card.innerHTML = `
          <div class="flex items-center justify-between mb-2">
            <div class="text-xs font-mono text-slate-400">Ticket #${ticket.id ?? '—'}</div>
            <span class="px-2 py-1 rounded-full border text-xs font-mono ${statusClass}">${ticket.status}</span>
          </div>
          <div class="text-lg font-semibold text-white">${ticket.guest_name || 'Unknown Guest'}</div>
          <div class="text-xs text-cyan-300 font-mono">Room ${ticket.room_number || '—'}</div>
          <div class="flex items-center gap-2 mt-3">
            <span class="px-2 py-1 rounded-full border text-xs font-mono ${sentimentClass}">${sentiment}</span>
            <span class="text-xs text-slate-400 font-mono" title="${utc}">${display}</span>
          </div>
          <p class="mt-3 text-sm text-slate-300 truncate-lines">${ticket.issue || 'No details provided.'}</p>
        `;
        card.addEventListener('click', () => openModal(ticket));
        ticketsGridEl.appendChild(card);
      });
    }

    function renderTable() {
      if (state.loading) {
        loadingStateEl.classList.remove('hidden');
        emptyStateEl.classList.add('hidden');
        ticketsGridEl.classList.add('hidden');
        renderError();
        return;
      }
      applyFilters();
      renderTickets();
    }

    function openModal(ticket) {
      const { display, utc } = formatLocalDateTime(ticket.created_at);
      modalTitleEl.textContent = `Ticket #${ticket.id ?? '—'}`;
      modalCreatedEl.textContent = `${display} (${utc})`;
      modalIdEl.textContent = `ID: ${ticket.id ?? '—'}`;
      modalStatusBadgeEl.textContent = `Status: ${ticket.status}`;
      modalSentimentBadgeEl.textContent = `Sentiment: ${ticket.sentiment || 'Neutral'}`;
      modalGuestEl.textContent = ticket.guest_name || 'Unknown';
      modalRoomEl.textContent = ticket.room_number || '—';
      modalStatusTextEl.textContent = ticket.status || '—';
      modalSentimentTextEl.textContent = ticket.sentiment || 'Neutral';
      modalIssueEl.textContent = ticket.issue || 'No details provided.';
      modalRawEl.textContent = JSON.stringify(ticket, null, 2);

      modalEl.classList.remove('hidden');
      modalEl.classList.add('flex');
      modalCloseEl.focus();
    }

    function closeModal() {
      modalEl.classList.add('hidden');
      modalEl.classList.remove('flex');
    }

    async function fetchDashboardData() {
      state.loading = true;
      renderTable();
      try {
        const [statsRes, ticketsRes] = await Promise.all([
          fetch(`${API_BASE_URL}/staff/dashboard-stats`),
          fetch(`${API_BASE_URL}/staff/recent-tickets`)
        ]);

        if (!statsRes.ok) throw new Error(`Stats error ${statsRes.status}`);
        if (!ticketsRes.ok) throw new Error(`Tickets error ${ticketsRes.status}`);

        const stats = await statsRes.json();
        const tickets = await ticketsRes.json();

        if (statTotalEl) statTotalEl.textContent = stats.total_tickets || 0;
        if (statOpenEl) statOpenEl.textContent = stats.open_tickets || 0;
        if (statSentimentEl) statSentimentEl.textContent = `${stats.sentiment_score || 0}%`;

        state.tickets = tickets;
        state.error = null;
      } catch (error) {
        state.error = error && error.message ? error.message : 'Failed to load data';
        state.tickets = [];
      } finally {
        state.loading = false;
        renderTable();
      }
    }

    async function fetchBuildMarker() {
      if (!buildMarkerEl) return;
      try {
        const response = await fetch(`${API_BASE_URL}/__build`);
        if (!response.ok) throw new Error('build unavailable');
        const data = await response.json();
        const sha = data.sha || 'unknown';
        const mark = data.mark || 'unknown';
        buildMarkerEl.textContent = `build: ${sha} • ${mark}`;
      } catch (error) {
        buildMarkerEl.textContent = 'build: unknown';
      }
    }

    if (searchInputEl) {
      searchInputEl.addEventListener('input', (event) => {
        state.filters.search = event.target.value || '';
        renderTable();
      });
    }

    if (filterStatusEl) {
      filterStatusEl.addEventListener('change', (event) => {
        state.filters.status = event.target.value;
        renderTable();
      });
    }

    if (sortCreatedBtn) {
      sortCreatedBtn.addEventListener('click', () => {
        state.sortDir = state.sortDir === 'desc' ? 'asc' : 'desc';
        sortCreatedBtn.textContent = state.sortDir === 'desc' ? 'Sort: Newest' : 'Sort: Oldest';
        renderTable();
      });
    }

    if (modalCloseEl) {
      modalCloseEl.addEventListener('click', closeModal);
    }

    if (modalOverlayEl) {
      modalOverlayEl.addEventListener('click', closeModal);
    }

    document.addEventListener('keydown', (event) => {
      if (event.key === 'Escape') {
        closeModal();
      }
    });

    if (modalCopyJsonBtn) {
      modalCopyJsonBtn.addEventListener('click', async () => {
        const rawText = modalRawEl ? modalRawEl.textContent : '';
        if (!rawText) return;
        const original = modalCopyJsonBtn.textContent;
        try {
          if (navigator.clipboard && navigator.clipboard.writeText) {
            await navigator.clipboard.writeText(rawText);
          }
          modalCopyJsonBtn.textContent = 'Copied';
        } catch (error) {
          modalCopyJsonBtn.textContent = 'Failed';
        } finally {
          setTimeout(() => {
            modalCopyJsonBtn.textContent = original;
          }, 1500);
        }
      });
    }

    if (testBtn) {
      testBtn.addEventListener('click', async () => {
        testBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';
        try {
          await fetch(`${API_BASE_URL}/staff/escalate`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              guest_name: "Test Guest",
              room_number: "101",
              issue: "I need extra towels and soap please."
            })
          });
          setTimeout(() => fetchDashboardData(), 1000);
        } catch (e) {
          console.error(e);
        } finally {
          testBtn.innerHTML = '<i class="fas fa-plus"></i> Test Ticket';
        }
      });
    }

    function startClock() {
      const update = () => {
        const now = new Date();
        document.getElementById('system-time').innerText = now.toLocaleTimeString();
      };
      update();
      setInterval(update, 1000);
    }

    function init() {
      startClock();
      fetchBuildMarker();
      fetchDashboardData();
      setInterval(fetchDashboardData, 3000);
    }

    init();
  </script>
</body>

</html>
